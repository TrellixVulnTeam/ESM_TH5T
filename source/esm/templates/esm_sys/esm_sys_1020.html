{% extends "esm_com/bizform.html" %} {% load static %} 
{% block header %} 

{% endblock %} 

{% block contents %}
<div class="container-fluid d-flex flex-column p-0 h-100">
  <!-- 검색 조건 영역 -->
  <div class="row no-gutters mb-2">
    <div class="col-12">
      <div class="search-header">
        <div class="search-title">
          <i class="xi-bars"> 조회조건</i>
        </div>
        <div class="search-buttons">
          <button class="btn_sub active" onclick="doAction1('print');"><i class="xi-print"> 출력</i></button>
          <button class="btn_sub active" onclick="doAction1('reset');"><i class="xi-refresh"> 초기화</i></button>
          <button class="btn_main active" onclick="doAction1('search');"><i class="xi-search"> 조회</i></button>
          <button class="btn_main active" onclick="doAction1('save');"><i class="xi-save"> 저장</i></button>
        </div>
      </div>
      <form id="srchForm" class="search-content">
        <label for="menuName">메뉴명</label>
        <input type="text" name="menuName" id="menuName" />
        <label for="url">URL</label>
        <input type="text" name="url" id="url" />
        <label for="useYn">사용여부</label>
        <input type="checkbox" name="useYn" id="useYn" />
      </form>
    </div>
  </div>
  <div class="row no-gutters flex-grow-1">
    <div class="col-12 d-flex flex-column">
      <div class="search-header">
        <div class="search-title">
          <i class="xi-sort-desc"> 메뉴목록 (47건)</i>
        </div>
        <div class="search-buttons">
          <button class="btn_sub active" onclick="doAction1('excelUpload');"><i class="xi-upload"> 엑셀업로드</i></button>
          <button class="btn_sub active" onclick="doAction1('excelDownload');"><i class="xi-download"> 엑셀다운로드</i></button>
          <button class="btn_sub active" onclick="doAction1('delRow');"><i class="xi-minus-min"> 행삭제</i></button>
          <button class="btn_sub active" onclick="doAction1('addRow');"><i class="xi-plus-min"> 행추가</i></button>          
        </div>
      </div>
      <div class="search-content flex-grow-1">
        <div id="realgrid" style="width: 100%; height: 100%"></div>
      </div>
    </div>
  </div>
</div>




<script>
  $(function () {
    var gridView; // GridView객체를 저장할 gridView변수를 정의 합니다.
    var dataProvider; // LocalDataProvider객체를 저장할 dataProvider변수를 정의 합니다.

    // LocalDataProvider와 GridView객체를 생성하고 GridView의 DataSource를 생성된 LocalDataProvider로 지정하는 코드를 추가 합니다.
    dataProvider = new RealGridJS.LocalDataProvider();
    gridView = new RealGridJS.GridView("realgrid");
    gridView.setDataSource(dataProvider);

    //새로운 DataField 배열 객체 생성
    var fields = [
      {
        fieldName: "field1",
      },
      {
        fieldName: "field2",
      },
    ];

    //setColumns()함수로 그리드에 반영
    dataProvider.setFields(fields);

    //새로운 DataColumn array 객체 생성
    var columns = [
      {
        name: "col1",
        fieldName: "field1",
        header: {
          text: "컬럼1",
        },
        width: 300,
      },
      {
        name: "col2",
        fieldName: "field2",
        header: {
          text: "컬럼2",
        },
        width: 300,
      },
    ];

    //setColumns()함수로 그리드에 반영
    gridView.setColumns(columns);

    //컬럼 이름이 "col1"인 컬럼의 heder객체를 가져온다.
    var header = gridView.getColumnProperty("col1", "header");

    //컬럼 헤더를 "컬럼1"로 바꾼다.
    header.text = "컬럼1";

    //헤더 객체를 GridView에 다시 넣는다.
    gridView.setColumnProperty("col1", "header", header);

    // 생성되어 있는 필드의 순서에 따라 앞에서 부터 입력되고, 남는 데이터는 버리게 됩니다.
    var data = [["data1", "data2", "data3"]];
    /* 객체표현도가능
    var data = [
        {field1:"value1", field2:"value2"}
    ];
    */
    // DataProvider가 가지고 있는 모든 데이터를 삭제하고 입력된 데이터로 교체합니다.
    dataProvider.setRows(data);
  });

  /* action1에대한 기능 */
  function doAction1(gubun) {
    switch (gubun) {
      /* 조회 */
      case "search":
        console.log("gubun ->", gubun);

        var menuName = $("#menuName").val();
        var url = $("#url").val();
        var useYn = $("#useYn").is(":checked") ? "1" : "0";

        // 보낼 파라미터
        var params = {
          menuName: menuName,
          url: url,
          useYn: useYn,
        };
        console.log("params ->", params);

        // ajax POST 통신, 후에 공통으로 뺄거임
        $.ajax({
          type: "POST",
          url: "/esm_sys_1020/search",
          data: params,
          // data: $('#srchForm').serialize(),
          dataType: "json",
          success: function (data) {
            var result = JSON.parse(data);
            console.log(result);
          },
        });
        break;
      case "reset":
        console.log("gubun ->", gubun);
        break;
      case "print":
        console.log("gubun ->", gubun);
        break;
      case "save":
        console.log("gubun ->", gubun);

        var menuName = $("#menuName").val();
        var url = $("#url").val();
        var useYn = $("#useYn").is(":checked") ? "1" : "0";

        // 보낼 파라미터
        var params = {
          menuName: menuName,
          url: url,
          useYn: useYn,
        };
        console.log("params ->", params);

        // ajax POST 통신, 후에 공통으로 뺄거임
        $.ajax({
          type: "POST",
          url: "/esm_sys_1020/save",
          data: params,
          // data: $('#srchForm').serialize(),
          dataType: "json",
          success: function (data) {
            var result = JSON.parse(data);

            console.log(result);
          },
        });
        break;
      case "addRow":
        console.log("gubun ->", gubun);
        break;
      case "delRow":
        console.log("gubun ->", gubun);
        break;
      case "excelDownload":
        console.log("gubun ->", gubun);
        break;
      case "excelUpload":
        alert(gubun);
        break;
    }
  }
</script>

{% endblock %}
